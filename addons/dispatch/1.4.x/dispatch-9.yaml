# Do NOT edit this file directly.
# File generated from clusteraddon.yaml.tmpl by the update-gitops-repo tool with arguments: /usr/bin/update-gitops-repo -branch= -create-pull-request=false '-commit-message='"'"'update mesosphere/dispatch image digest to 1.4.5'"'"'' -substitute=chartVersion=1.4.5 -substitute=chartRepo=https://mesosphere.github.io/dispatch -substitute=minioDefaultSize=50Gi -substitute=buildName=1-4-5 -substitute=dispatchImage=mesosphere/dispatch@sha256:4af107ab88ff7152c9082012839a2ca3240d2527b87158ea6e5da0409a114058 -substitute=dispatchTestImage=mesosphere/dispatch-helm-test:1.4.5 -substitute=helmImage=mesosphere/dispatch-helm:1.4.5 -substitute=kindImage=mesosphere/dispatch-kind@sha256:2cbafa004963526cd55e02998f19084ef038cce91b9f8ae5b7c731778c56a3d1 -substitute=dindImage=mesosphere/dispatch-dind@sha256:49ec9ace8525ca0626b3cb743a06516e4c9f357893208c3c2a2c3fe7e55724fb -substitute=testutilsImage=mesosphere/dispatch-testutils@sha256:19f166b18bf74fa21f2717c2089e1bee10f0c12ca2cac1769108e41ae35e024c -substitute=entrypointImage=mesosphere/dispatch-entrypoint@sha256:acb4ba6e8689dadec759c3c31ede1e0c5fcaab8d1bb7d40dd6055e125deafd5c -substitute=gsutilImage=mesosphere/dispatch-gsutil@sha256:b0d6db342670f1d142a81ebb0c77ddec0e9862333d3560ef6094401187823f20 -substitute=docsImage=mesosphere/dispatch-docs:1.4.5 -substitute=buildkitMemory=4Gi -substitute=buildkitCPU=4000m -substitute=buildkitEnabled=false -compile-only -git-ignore -verbose

apiVersion: kubeaddons.mesosphere.io/v1beta2
kind: ClusterAddon
metadata:
  name: dispatch
  labels:
    kubeaddons.mesosphere.io/name: dispatch
    kubeaddons.mesosphere.io/hack-requires-defaultstorageclass: "true"
  annotations:
    catalog.kubeaddons.mesosphere.io/addon-revision: "1.4.5"

    # Dispatch
    appversion.kubeaddons.mesosphere.io/dispatch: "1.4.5"
    endpoint.kubeaddons.mesosphere.io/dispatch: /dispatch/dashboard 
    docs.kubeaddons.mesosphere.io/dispatch: "https://docs.d2iq.com/dkp/dispatch/latest/"

    # Tekton
    appversion.kubeaddons.mesosphere.io/tekton: "0.16.3"
    endpoint.kubeaddons.mesosphere.io/tekton: /dispatch/tekton/
    docs.kubeaddons.mesosphere.io/tekton: "https://docs.d2iq.com/dkp/dispatch/latest/"

    # Argo CD
    appversion.kubeaddons.mesosphere.io/argo-cd: "1.6.2"
    endpoint.kubeaddons.mesosphere.io/argo-cd: /dispatch/argo-cd
    docs.kubeaddons.mesosphere.io/argo-cd: "https://argoproj.github.io/argo-cd/user-guide/"

    values.chart.helm.kubeaddons.mesosphere.io/dispatch: "https://raw.githubusercontent.com/mesosphere/charts/master/stable/dispatch/values.yaml"
spec:
  namespace: dispatch
  kubernetes:
    minSupportedVersion: v1.15.6
  cloudProvider:
    - name: aws
      enabled: false
    - name: azure
      enabled: false
    - name: gcp
      enabled: false
    - name: vsphere
      enabled: false
    - name: docker
      enabled: false
    - name: none
      enabled: false
  requires:
    - matchLabels:
        kubeaddons.mesosphere.io/name: prometheus
    - matchLabels:
        kubeaddons.mesosphere.io/name: cert-manager
  chartReference:
    chart: dispatch
    repo: "https://mesosphere.github.io/dispatch"
    version: "1.4.5"
    valuesRemap:
      "argo-cd.server.ingress.annotations.traefik\\.ingress\\.kubernetes\\.io/auth-url": "ingress.auth.auth-url"
    values: |
      ---
      argo-cd:
        enabled: false
        controller:
          metrics:
            enabled: true
            serviceMonitor:
              additionalLabels:
                release: prometheus-kubeaddons
        server:
          metrics:
            enabled: true
            serviceMonitor:
              additionalLabels:
                release: prometheus-kubeaddons
        ingress:
          annotations:
            # This value is overridden if a composite values configmap is present
            # see: https://github.com/mesosphere/ksphere-platform/blob/master/keps/sig-ksphere-catalog/20200413-addon-composite-values.md
            traefik.ingress.kubernetes.io/auth-url: "http://traefik-forward-auth-kubeaddons.kubeaddons.svc.cluster.local:4181/"
        repoServer:
          metrics:
            enabled: true
            serviceMonitor:
              additionalLabels:
                release: prometheus-kubeaddons
      dispatch:
        image: "mesosphere/dispatch:1.4.5"
        testImage: "mesosphere/dispatch-helm-test:1.4.5"
      kommander-ui:
        image:
          defaultTag: 6.98.0
      tekton:
        controller:
          images:
            entrypoint: "mesosphere/dispatch-entrypoint:1.4.5"
            gsutil: "mesosphere/dispatch-gsutil:1.4.5"
        webhook:
          replicas: 3 # tekton webhook
      global:
        prometheus:
          enabled: true
          release: prometheus-kubeaddons
        grafana:
          enabled: true
          namespace: kubeaddons
      minio:
        persistence:
          size: "50Gi" # minio
      buildkit:
        enabled: false # buildkit
        resources:
          limits:
            cpu: "4000m" # buildkit
            memory: "4Gi" # buildkit
          requests:
            cpu: "4000m" # buildkit
            memory: "4Gi" # buildkit
      flux:
        helmRepo: "https://mesosphere.github.io/dispatch"
